task build(type:Exec) {
  workingDir "."
  commandLine "docker", "build", "-t" , "${project.name}", "."
}

task test(type:Exec) {
  workingDir "."
  commandLine "docker", "run", "-v" , "/var/run/docker.sock:/var/run/docker.sock", "-v", "${workingDir}:/usr/src/app/spec", "enieuw/serverspec"
}

task destroySampleApp(type:Exec) {
  workingDir "."
  ignoreExitValue true
  commandLine "fleetctl", "destroy", "sample-app"
}

task submitSampleApp(type:Exec) {
  workingDir "."
  commandLine "fleetctl", "submit", "sample-app"
}

task startSampleApp(type:Exec) {
  workingDir "."
  commandLine "fleetctl", "start", "sample-app"
}

task deploy << {
    println "Deploy artifact"
}

task testIntegration << {
    println "Integration test"
}

deploy.dependsOn destroySampleApp, submitSampleApp, startSampleApp
